{% extends "base.html" %}
{% block title %}Your Results{% endblock %}

{% block content %}
<div class="card">
    <h1>Results for {{ candidate.name }}</h1>
    <p class="subtitle">Applied for: <strong>{{ job_ad.title }}</strong> at {{ job_ad.company }}</p>

    <div class="score-section">
        <div class="score-label">Compatibility Score</div>
        <div class="score-bar-container">
            <div class="score-bar
                {% if candidate.score >= 70 %}score-high
                {% elif candidate.score >= 40 %}score-medium
                {% else %}score-low{% endif %}"
                style="width: {{ candidate.score }}%">
                {{ candidate.score }}%
            </div>
        </div>
        <p class="score-detail">
            {{ matched.must_have|length }}/{{ matched.must_have|length + missing.must_have|length }} must-have,
            {{ matched.nice_to_have|length }}/{{ matched.nice_to_have|length + missing.nice_to_have|length }} nice-to-have
            (must-have keywords count 3&times; more)
        </p>
    </div>
</div>

<div class="card">
    <h2>Matched Keywords</h2>
    {% if matched.must_have or matched.nice_to_have %}
    <div class="keyword-list">
        {% for kw in matched.must_have %}
        <span class="keyword keyword-match keyword-must-have">{{ kw }}</span>
        {% endfor %}
        {% for kw in matched.nice_to_have %}
        <span class="keyword keyword-match keyword-nice-to-have">{{ kw }}</span>
        {% endfor %}
    </div>
    <p class="tier-legend">Solid border = must-have (3 pts) · Dashed border = nice-to-have (1 pt)</p>
    {% else %}
    <p>No keywords matched.</p>
    {% endif %}
</div>

<div class="card">
    <h2>Missing Keywords</h2>
    {% if missing.must_have or missing.nice_to_have %}
    <div class="keyword-list">
        {% for kw in missing.must_have %}
        <span class="keyword keyword-missing keyword-must-have">{{ kw }}</span>
        {% endfor %}
        {% for kw in missing.nice_to_have %}
        <span class="keyword keyword-missing keyword-nice-to-have">{{ kw }}</span>
        {% endfor %}
    </div>
    <p class="tier-legend">Solid border = must-have (3 pts) · Dashed border = nice-to-have (1 pt)</p>
    {% else %}
    <p>All keywords matched!</p>
    {% endif %}
</div>

{% if suggestions %}
<div class="card">
    <h2>Suggestions</h2>
    <ul class="suggestions-list">
        {% for suggestion in suggestions %}
        <li>{{ suggestion }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="actions">
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Upload Another CV</a>
</div>
{% endblock %}
